{% extends "layouts/moj.html" %}

{% block pageTitle %}
  Electronic Monitoring notification form - Electronic Monitoring
{% endblock %}

{% block beforeContent %}
<!-- Breadcrumb -->
<a href="dashboard" action="action" class="govuk-back-link">Back</a>
{% endblock %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

     <!-- {% set html %}
        <p class="govuk-notification-banner__heading">
         This form was submitted on the 14 December 2024.
        </p>
      {% endset %}

   {% if (data['view'] == 'true') %}

      {{ govukNotificationBanner({
        html: html
      }) }}

    {% else %}
              
    {% endif %}   -->

      <h1 class="govuk-heading-l">Electronic Monitoring Notification form for {{ data['fullname'] or "David Murphy" }}</h1>

       {% if (data['view'] == 'true') %}

           {% if (data['variation'] == 'false') %}

           {% if (data['view-variation'] == 'false') %}

        


           <p> This notification form was submitted on the 14 December 2024. You can make a change to this form or end all monitoring for the device wearer.</p>

                 <form class="form" action="edit-form-variation" method="post">

            {% elseif (data['view-variation'] == 'cancelled') %}

           <p> This notification form was cancelled on the 22 December 2024.</p>
      

            {% else %}

            <p> This notification form was submitted on the 1 December 2024. You can't make changes to it because there are more recent versions of this form. </p>

            <details class="govuk-details">
                <summary class="govuk-details__summary">
                  <span class="govuk-details__summary-text">
                    View history of this form
                  </span>
                </summary>
                <div class="govuk-details__text">

                 <div class="moj-timeline">
                    <div class="moj-timeline__item">

                      <div class="moj-timeline__header">
                        <h2 class="moj-timeline__title">Changes to the form submitted</h2>

                        <p class="moj-timeline__byline">by Joe Bloggs</p>

                      </div>

                      <p class="moj-timeline__date">
                        <time datetime="2019-06-14T14:01:00.000Z">14 December 2024 at 2:01pm</time>
                      </p>

                       <div class="moj-timeline__description govuk-!-padding-bottom-4"><a href="submitted-form?view-variation=false&variation=true">View the most recent version of this form</a>.<br>
                       </div>

                      

                    </div>

                    <div class="moj-timeline__item">

                      <div class="moj-timeline__header">
                        <h2 class="moj-timeline__title">Form submitted</h2>

                        <p class="moj-timeline__byline">by John Smith</p>

                      </div>

                      <p class="moj-timeline__date">
                        <time datetime="2019-06-07T12:32:00.000Z">1 December 2024 at 12:32pm</time>
                      </p>

                      <div class="moj-timeline__description govuk-!-padding-bottom-4">
                        <p>You are viewing this version of the form.</p>
                      </div>

                    </div>

                    
                  </div>

                </div>

              </details>

            
            {% endif %}      


            {% else %}

            <p> This version of the notification form was submitted on the 14 December 2024. You can make changes to this form or end all monitoring for the device wearer. </p>
            

            <details class="govuk-details">
                <summary class="govuk-details__summary">
                  <span class="govuk-details__summary-text">
                    View history of this form
                  </span>
                </summary>
                <div class="govuk-details__text">

                 <div class="moj-timeline">
                    <div class="moj-timeline__item">

                      <div class="moj-timeline__header">
                        <h2 class="moj-timeline__title">Changes to the form submitted</h2>

                        <p class="moj-timeline__byline">by Joe Bloggs</p>

                      </div>

                      <p class="moj-timeline__date">
                        <time datetime="2019-06-14T14:01:00.000Z">14 December 2024 at 2:01pm</time>
                      </p>

                      <div class="moj-timeline__description govuk-!-padding-bottom-4">
                        <p>You are viewing the most recent version of the form.</p>
                      </div>

                    </div>

                    <div class="moj-timeline__item">

                      <div class="moj-timeline__header">
                        <h2 class="moj-timeline__title">Form submitted</h2>

                        <p class="moj-timeline__byline">by John Smith</p>

                      </div>

                      <p class="moj-timeline__date">
                        <time datetime="2019-06-07T12:32:00.000Z">1 December 2024 at 12:32pm</time>
                      </p>

                      <div class="moj-timeline__description govuk-!-padding-bottom-4"><a href="submitted-form?view-variation=true&variation=false">View submitted form</a></div>

                    </div>

                    
                  </div>

                </div>

              </details>

                 <form class="form" action="edit-form-variation" method="post">

            {% endif %} 

        {% else %}

         <p> You are making changes to a notification form that was submitted on the 14 December 2024. Edit the sections that you need to change.</p>


              <form class="form" action="submit-confirmation?variation=true" method="post">
              
       {% endif %}   



  <!-- <h2 class="govuk-heading-m">Notification form sections</h2>-->

      {% set completedStatus = {
        text: "Completed"
      } %}

      {% set viewStatus = {
        text: ""
      } %}

      {% set tocheckStatus = {
        tag: {
          text: "To check",
          classes: "govuk-tag--blue"
        }
      } %}

      {% set incompleteStatus = {
        tag: {
          text: "Incomplete",
          classes: "govuk-tag--blue"
        }
      } %}

 {% if (data['view'] == 'true') %}


      {{ govukTaskList({
        idPrefix: "first-section",
        items: [
          {
            title: {
              text: "About the notifying and responsible organisations"
            },
            href: ("organisation/check-answers-view"),
             status: ( viewStatus)
          },
          {
            title: {
              text: "About the device wearer"
            },
            href: ("device-wearer/check-answers-view"),
            status: (viewStatus)
          },
          {
            title: {
              text: "Monitoring conditions"
            },
            href: ("monitoring-conditions/check-answers-view"),
             status: ( viewStatus)
          },
          {
            title: {
              text: "Access needs and installation risk information"
            },
            href: ("installation/check-answers-view"),
            status: ( viewStatus)
          },
          {
            title: {
              text: "Attachments"
            },
            href: ("attachments/check-answers-view"),
            status: ( viewStatus)
          },
          {
            title: {
              text: "About the changes in this version of the form"
            },
            href: ("edit-form-question"),
            classes: ("govuk-visually-hidden" if data['variation'] == 'false'),
            status: ( viewStatus )
          },
          {
            title: {
              text: "About the cancellation"
            },
            href: ("edit-form-delete-question"),
            classes: ("govuk-visually-hidden" if data['view-variation'] !== 'cancelled'),
            status: ( viewStatus )
          }

        ]
      }) }}

      {% else %}

        {{ govukTaskList({
        idPrefix: "first-section",
        items: [
          {
            title: {
              text: "About the notifying and responsible organisations"
            },
            href: ("organisation/check-answers-view"),
            status: ( completedStatus if data['section-2-complete'] == 'true' else tocheckStatus)
          },
          {
            title: {
              text: "About the device wearer"
            },
            href: ("device-wearer/check-answers-view"),
            status: ( completedStatus if data['section-1-complete'] == 'true' else tocheckStatus)
          },
          {
            title: {
              text: "Monitoring conditions"
            },
            href: ("monitoring-conditions/check-answers-view"),
            status: (completedStatus if data['section-4-complete'] == 'true' else tocheckStatus)
          },
          {
            title: {
              text: "Access needs and installation risk information"
            },
            href: ("installation/check-answers-view"),
           status: ( completedStatus if data['section-3-complete'] == 'true' else tocheckStatus)
          },
          {
            title: {
              text: "Attachments"
            },
            href: ("attachments/check-answers-view"),
           status: ( completedStatus if data['section-5-complete'] == 'true' else tocheckStatus)
          },
          {
            title: {
              text: ("About the changes in this version of the form")
            },
            href: ("edit-form-question"),
           status: ( completedStatus if data['section-6-complete'] == 'true' else incompleteStatus)
          }

        ]
      }) }}

      {% endif%}

       {% if (data['view'] == 'true') %}

          <img src="/public/images/form_download.svg" alt="PDF download icon">

           {{ govukButton({
          text: ("View submitted notification form" if data['variation'] == 'true' else "View submitted notification form"),
          href: '#',
          classes: "govuk-button--secondary"
        }) }}


         
          {% else %}    

          

          {% endif %}  




      <div class="govuk-!-margin-top-5">
       <div class="govuk-button-group">

           {% if (data['view'] == 'true') %}

            {% if (data['view-variation'] == 'true') %}

            {% elseif (data['view-variation'] == 'cancelled') %}
          
           {% else %}

           <button type="submit" class="govuk-button" data-module="govuk-button">
           Make changes to this form
          </button>

          <a class="govuk-link" href="edit-form-delete-question">End all monitoring</a>

            {% endif %}


          {% else %}
              {% if (data['section-1-complete'] == 'true' and data['section-2-complete'] == 'true' and data['section-3-complete'] == 'true' and data['section-4-complete'] == 'true' and data['section-5-complete'] == 'true' and data['section-6-complete'] == 'true') %}
              <button type="submit" class="govuk-button" data-module="govuk-button">
                Submit changes to the form
              </button>

              <a class="govuk-link" href="delete-form">Delete draft</a>
              {% else %}
              <button type="submit" class="govuk-button" disabled data-module="govuk-button">
                Submit changes to the form
              </button>

               <a class="govuk-link" href="delete-form">Delete draft</a>

              {% endif %}
          {% endif %}



        
        </div>
      </div>
    </form>

    </div>
  </div>
{% endblock %}
